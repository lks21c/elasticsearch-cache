package com.elasticsearchcache;

import com.elasticsearchcache.service.ParsingService;
import org.elasticsearch.index.query.QueryBuilder;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import java.io.IOException;

@RunWith(SpringRunner.class)
@SpringBootTest
public class ParsingServiceTest {

    @Autowired
    ParsingService parsingService;

    @Test
    public void name() throws IOException {
        String q = "{\n" +
                "    \"bool\" : {\n" +
                "      \"must\" : [\n" +
                "        {\n" +
                "          \"query_string\" : {\n" +
                "            \"query\" : \"_exists_:poc_nm AND ( poc_code:AS40 OR poc_code:IS40 )\",\n" +
                "            \"fields\" : [ ],\n" +
                "            \"use_dis_max\" : true,\n" +
                "            \"tie_breaker\" : 0.0,\n" +
                "            \"default_operator\" : \"or\",\n" +
                "            \"auto_generate_phrase_queries\" : false,\n" +
                "            \"max_determinized_states\" : 10000,\n" +
                "            \"enable_position_increments\" : true,\n" +
                "            \"fuzziness\" : \"AUTO\",\n" +
                "            \"fuzzy_prefix_length\" : 0,\n" +
                "            \"fuzzy_max_expansions\" : 50,\n" +
                "            \"phrase_slop\" : 0,\n" +
                "            \"escape\" : false,\n" +
                "            \"split_on_whitespace\" : true,\n" +
                "            \"boost\" : 1.0\n" +
                "          }\n" +
                "        },\n" +
                "        {\n" +
                "          \"range\" : {\n" +
                "            \"ts\" : {\n" +
                "              \"from\" : \"2017-01-01T00:00:00\",\n" +
                "              \"to\" : \"2018-01-01T00:00:00\",\n" +
                "              \"include_lower\" : true,\n" +
                "              \"include_upper\" : false,\n" +
                "              \"time_zone\" : \"+09:00\",\n" +
                "              \"boost\" : 1.0\n" +
                "            }\n" +
                "          }\n" +
                "        }\n" +
                "      ],\n" +
                "      \"disable_coord\" : false,\n" +
                "      \"adjust_pure_negative\" : true,\n" +
                "      \"boost\" : 1.0\n" +
                "    }\n" +
                "  }";

        QueryBuilder qb = parsingService.parseQuery(q);

        System.out.println("name = " + qb.getName());
    }

    @Test
    public void test2() {
        String res = "{\"took\":79,\"timed_out\":false,\"num_reduce_phases\":2,\"_shards\":{\"total\":628,\"successful\":628,\"failed\":0},\"hits\":{\"total\":592256872,\"max_score\":0.0,\"hits\":[]},\"aggregations\":{\"date_histogram#dates\":{\"buckets\":[{\"key_as_string\":\"2017-11-26T00:00:00.000+09:00\",\"key\":1511622000000,\"doc_count\":1695,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":1016,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-11-01T00:00:00.000+09:00\",\"key\":1509462000000,\"doc_count\":1016,\"sum#sum\":{\"value\":1105.0}}]}},{\"key\":\"iPhone App\",\"doc_count\":679,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-11-01T00:00:00.000+09:00\",\"key\":1509462000000,\"doc_count\":679,\"sum#sum\":{\"value\":701.0}}]}}]}},{\"key_as_string\":\"2017-11-27T00:00:00.000+09:00\",\"key\":1511708400000,\"doc_count\":16806238,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9635997,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-11-01T00:00:00.000+09:00\",\"key\":1509462000000,\"doc_count\":9635997,\"sum#sum\":{\"value\":5.2006003E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7170241,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-11-01T00:00:00.000+09:00\",\"key\":1509462000000,\"doc_count\":7170241,\"sum#sum\":{\"value\":3.1365357E7}}]}}]}},{\"key_as_string\":\"2017-11-28T00:00:00.000+09:00\",\"key\":1511794800000,\"doc_count\":16958729,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9653587,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-11-01T00:00:00.000+09:00\",\"key\":1509462000000,\"doc_count\":9653587,\"sum#sum\":{\"value\":5.2112605E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7305142,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-11-01T00:00:00.000+09:00\",\"key\":1509462000000,\"doc_count\":7305142,\"sum#sum\":{\"value\":3.1857527E7}}]}}]}},{\"key_as_string\":\"2017-11-29T00:00:00.000+09:00\",\"key\":1511881200000,\"doc_count\":17315783,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9921927,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-11-01T00:00:00.000+09:00\",\"key\":1509462000000,\"doc_count\":9921927,\"sum#sum\":{\"value\":5.2928055E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7393856,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-11-01T00:00:00.000+09:00\",\"key\":1509462000000,\"doc_count\":7393856,\"sum#sum\":{\"value\":3.2089141E7}}]}}]}},{\"key_as_string\":\"2017-11-30T00:00:00.000+09:00\",\"key\":1511967600000,\"doc_count\":17128401,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9795780,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-11-01T00:00:00.000+09:00\",\"key\":1509462000000,\"doc_count\":9795780,\"sum#sum\":{\"value\":5.2613948E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7332621,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-11-01T00:00:00.000+09:00\",\"key\":1509462000000,\"doc_count\":7332621,\"sum#sum\":{\"value\":3.2171146E7}}]}}]}},{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":17110578,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9819110,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9819110,\"sum#sum\":{\"value\":5.3582726E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7291468,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7291468,\"sum#sum\":{\"value\":3.1907591E7}}]}}]}},{\"key_as_string\":\"2017-12-02T00:00:00.000+09:00\",\"key\":1512140400000,\"doc_count\":17969293,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":10497417,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":10497417,\"sum#sum\":{\"value\":6.1584398E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7471876,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7471876,\"sum#sum\":{\"value\":3.584742E7}}]}}]}},{\"key_as_string\":\"2017-12-03T00:00:00.000+09:00\",\"key\":1512226800000,\"doc_count\":16549082,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9527523,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9527523,\"sum#sum\":{\"value\":5.4907636E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7021559,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7021559,\"sum#sum\":{\"value\":3.2799443E7}}]}}]}},{\"key_as_string\":\"2017-12-04T00:00:00.000+09:00\",\"key\":1512313200000,\"doc_count\":17040254,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9655214,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9655214,\"sum#sum\":{\"value\":5.3647593E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7385040,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7385040,\"sum#sum\":{\"value\":3.3585197E7}}]}}]}},{\"key_as_string\":\"2017-12-05T00:00:00.000+09:00\",\"key\":1512399600000,\"doc_count\":17144975,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9704721,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9704721,\"sum#sum\":{\"value\":5.4054779E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7440254,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7440254,\"sum#sum\":{\"value\":3.3800376E7}}]}}]}},{\"key_as_string\":\"2017-12-06T00:00:00.000+09:00\",\"key\":1512486000000,\"doc_count\":17146790,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9798093,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9798093,\"sum#sum\":{\"value\":5.4905064E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7348697,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7348697,\"sum#sum\":{\"value\":3.3371888E7}}]}}]}},{\"key_as_string\":\"2017-12-07T00:00:00.000+09:00\",\"key\":1512572400000,\"doc_count\":17050619,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9720876,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9720876,\"sum#sum\":{\"value\":5.4195196E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7329743,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7329743,\"sum#sum\":{\"value\":3.3110875E7}}]}}]}},{\"key_as_string\":\"2017-12-08T00:00:00.000+09:00\",\"key\":1512658800000,\"doc_count\":17181517,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9819820,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9819820,\"sum#sum\":{\"value\":5.4952237E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7361697,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7361697,\"sum#sum\":{\"value\":3.321847E7}}]}}]}},{\"key_as_string\":\"2017-12-09T00:00:00.000+09:00\",\"key\":1512745200000,\"doc_count\":17017131,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9777048,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9777048,\"sum#sum\":{\"value\":5.7055799E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7240083,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7240083,\"sum#sum\":{\"value\":3.3746344E7}}]}}]}},{\"key_as_string\":\"2017-12-10T00:00:00.000+09:00\",\"key\":1512831600000,\"doc_count\":16255542,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9316690,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9316690,\"sum#sum\":{\"value\":5.4319346E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":6938852,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":6938852,\"sum#sum\":{\"value\":3.2844301E7}}]}}]}},{\"key_as_string\":\"2017-12-11T00:00:00.000+09:00\",\"key\":1512918000000,\"doc_count\":17018059,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9703301,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9703301,\"sum#sum\":{\"value\":5.485662E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7314758,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7314758,\"sum#sum\":{\"value\":3.3905843E7}}]}}]}},{\"key_as_string\":\"2017-12-12T00:00:00.000+09:00\",\"key\":1513004400000,\"doc_count\":17093276,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9710494,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9710494,\"sum#sum\":{\"value\":5.5704221E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7382782,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7382782,\"sum#sum\":{\"value\":3.4394164E7}}]}}]}},{\"key_as_string\":\"2017-12-13T00:00:00.000+09:00\",\"key\":1513090800000,\"doc_count\":17198999,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9804300,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9804300,\"sum#sum\":{\"value\":5.6230084E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7394699,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7394699,\"sum#sum\":{\"value\":3.440284E7}}]}}]}},{\"key_as_string\":\"2017-12-14T00:00:00.000+09:00\",\"key\":1513177200000,\"doc_count\":17120509,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9701595,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9701595,\"sum#sum\":{\"value\":5.5129431E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7418914,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7418914,\"sum#sum\":{\"value\":3.437934E7}}]}}]}},{\"key_as_string\":\"2017-12-15T00:00:00.000+09:00\",\"key\":1513263600000,\"doc_count\":17168730,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9801636,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9801636,\"sum#sum\":{\"value\":5.5130469E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7367094,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7367094,\"sum#sum\":{\"value\":3.3384354E7}}]}}]}},{\"key_as_string\":\"2017-12-16T00:00:00.000+09:00\",\"key\":1513350000000,\"doc_count\":16956758,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9709158,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9709158,\"sum#sum\":{\"value\":5.5949646E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7247600,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7247600,\"sum#sum\":{\"value\":3.3344335E7}}]}}]}},{\"key_as_string\":\"2017-12-17T00:00:00.000+09:00\",\"key\":1513436400000,\"doc_count\":16045325,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9175222,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9175222,\"sum#sum\":{\"value\":5.2889199E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":6870103,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":6870103,\"sum#sum\":{\"value\":3.1925302E7}}]}}]}},{\"key_as_string\":\"2017-12-18T00:00:00.000+09:00\",\"key\":1513522800000,\"doc_count\":16899088,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9532935,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9532935,\"sum#sum\":{\"value\":5.3122289E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7366153,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7366153,\"sum#sum\":{\"value\":3.3628628E7}}]}}]}},{\"key_as_string\":\"2017-12-19T00:00:00.000+09:00\",\"key\":1513609200000,\"doc_count\":18769685,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":10516692,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":10516692,\"sum#sum\":{\"value\":5.989081E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":8252993,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":8252993,\"sum#sum\":{\"value\":3.990981E7}}]}}]}},{\"key_as_string\":\"2017-12-20T00:00:00.000+09:00\",\"key\":1513695600000,\"doc_count\":17005006,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9609565,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9609565,\"sum#sum\":{\"value\":5.3175555E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7395441,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7395441,\"sum#sum\":{\"value\":3.3663085E7}}]}}]}},{\"key_as_string\":\"2017-12-21T00:00:00.000+09:00\",\"key\":1513782000000,\"doc_count\":16760054,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9444698,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9444698,\"sum#sum\":{\"value\":5.1956824E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7315356,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7315356,\"sum#sum\":{\"value\":3.2881891E7}}]}}]}},{\"key_as_string\":\"2017-12-22T00:00:00.000+09:00\",\"key\":1513868400000,\"doc_count\":16703308,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9477857,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9477857,\"sum#sum\":{\"value\":5.2485749E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7225451,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7225451,\"sum#sum\":{\"value\":3.2056306E7}}]}}]}},{\"key_as_string\":\"2017-12-23T00:00:00.000+09:00\",\"key\":1513954800000,\"doc_count\":16924798,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9709274,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9709274,\"sum#sum\":{\"value\":5.5601338E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7215524,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7215524,\"sum#sum\":{\"value\":3.2996083E7}}]}}]}},{\"key_as_string\":\"2017-12-24T00:00:00.000+09:00\",\"key\":1514041200000,\"doc_count\":16234426,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9198104,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9198104,\"sum#sum\":{\"value\":5.3038975E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7036322,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7036322,\"sum#sum\":{\"value\":3.28621E7}}]}}]}},{\"key_as_string\":\"2017-12-25T00:00:00.000+09:00\",\"key\":1514127600000,\"doc_count\":16094414,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9140837,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9140837,\"sum#sum\":{\"value\":5.1709632E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":6953577,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":6953577,\"sum#sum\":{\"value\":3.1662994E7}}]}}]}},{\"key_as_string\":\"2017-12-26T00:00:00.000+09:00\",\"key\":1514214000000,\"doc_count\":17437660,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":10045853,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":10045853,\"sum#sum\":{\"value\":5.7346591E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7391807,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7391807,\"sum#sum\":{\"value\":3.4724117E7}}]}}]}},{\"key_as_string\":\"2017-12-27T00:00:00.000+09:00\",\"key\":1514300400000,\"doc_count\":17035948,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9691121,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9691121,\"sum#sum\":{\"value\":5.5357676E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7344827,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7344827,\"sum#sum\":{\"value\":3.4028946E7}}]}}]}},{\"key_as_string\":\"2017-12-28T00:00:00.000+09:00\",\"key\":1514386800000,\"doc_count\":16502789,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9354952,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9354952,\"sum#sum\":{\"value\":5.218882E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7147837,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7147837,\"sum#sum\":{\"value\":3.2041203E7}}]}}]}},{\"key_as_string\":\"2017-12-29T00:00:00.000+09:00\",\"key\":1514473200000,\"doc_count\":16576036,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9416352,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9416352,\"sum#sum\":{\"value\":5.2774073E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7159684,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7159684,\"sum#sum\":{\"value\":3.1959929E7}}]}}]}},{\"key_as_string\":\"2017-12-30T00:00:00.000+09:00\",\"key\":1514559600000,\"doc_count\":16411057,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":9385230,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":9385230,\"sum#sum\":{\"value\":5.3672568E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":7025827,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":7025827,\"sum#sum\":{\"value\":3.2314328E7}}]}}]}},{\"key_as_string\":\"2017-12-31T00:00:00.000+09:00\",\"key\":1514646000000,\"doc_count\":15624320,\"sterms#term\":{\"doc_count_error_upper_bound\":0,\"sum_other_doc_count\":0,\"buckets\":[{\"key\":\"Android Phone App\",\"doc_count\":8922412,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":8922412,\"sum#sum\":{\"value\":5.0669631E7}}]}},{\"key\":\"iPhone App\",\"doc_count\":6701908,\"date_histogram#time\":{\"buckets\":[{\"key_as_string\":\"2017-12-01T00:00:00.000+09:00\",\"key\":1512054000000,\"doc_count\":6701908,\"sum#sum\":{\"value\":3.0157748E7}}]}}]}}]}}}";
        System.out.println("res = " + res);
        String resBody = parsingService.generateTermsRes(res);
        System.out.println("resBody = " + resBody);
    }
}
